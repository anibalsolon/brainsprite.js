<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta charset="UTF-8">
  <title>brainsprite</title>
  <link rel="stylesheet" href="//unpkg.com/docsify/themes/dark.css">
  <style>
    canvas {
      width: 100%;
      max-width: 700px;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <script type="text/javascript" src="assets/brainsprite.js"></script>
  <script type="text/javascript" src="assets/brainsprite.modules.js"></script>
  <script>
    function viewer(logo) {
      window.brain = brainsprite({
        canvas: window.canvas,
        interactive: true,
        layers: [
          {
            sprite:  './tests/sprite.jpg',
            slices: { Y: 233 , Z: 189 },
          },
          {
            sprite: './tests/dmnSprite.png',
            slices: { Y: 233 , Z: 189 },
            opacity: 0.5,
          },
          {
            module: 'cross',
          },
        ],
        modules: {
          cross: {
            module: brainsprite.modules.cross,
          }
        },
      });

      var resizer = function(){
        // window.canvas.height = window.canvas.offsetWidth * 0.365;
        window.canvas.height = 200;
        window.brain.resize();
      };

      window.brain.addEventListener('init', function(){
        var p = logo.parentNode;
        p.appendChild(window.canvas);
        logo.remove();
        resizer();
      });

      window.addEventListener('resize', resizer, false);
    }

    function waitImage(callback) {
      var logo = document.querySelector('img[alt="logo"]');
      if (!logo || !logo.parentNode || !logo.complete) {
        setTimeout(function() { waitImage(callback); }, 500);
      } else {
        callback(logo);
      }
    }

    function initViewer() {
      if (typeof window.brain == 'undefined') {
        waitImage(function(logo){
          window.canvas = document.createElement('canvas');
          // window.canvas.width = logo.offsetWidth;
          // window.canvas.height = logo.offsetWidth * 0.37;
          viewer(logo);
        });
      }
    }

    window.$docsify = {
      name: 'brainsprite',
      repo: 'https://github.com/SIMEXP/brainsprite.js',
      coverpage: true,
      subMaxLevel: 2,
      autoHeader: true,
      plugins: [
        function (hook) {
          hook.ready(function() {
            initViewer();
          });
        }
      ]
    }
  </script>
  <script src="https://unpkg.com/docsify/lib/docsify.min.js"></script>
</body>
</html>
